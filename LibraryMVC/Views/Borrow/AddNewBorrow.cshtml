<div class="demo-section k-content" id="Testowy">
    <h4>Users</h4>
    <div id="dropDownDiv">
        @(Html.Kendo().DropDownList()
          .Name("UserId")
          .DataTextField("Name")
          .DataValueField("UserId")
          .DataSource(source =>
          {
              source.Read(read =>
              {
                  read.Action("GetUsers", "Borrow");
              });
          })
          .HtmlAttributes(new { style = "width: 100%" })
        )
        <p></p>
        <div>
            @(Html.Kendo().DropDownList()
          .Name("dropdownlist1")
          .DataTextField("Title")
          .DataValueField("BookId")
          .CascadeFromField("cascadeDD")
          .DataSource(source =>
          {
              source.Read(read =>
              {
                  read.Action("RetrieveBorrows/1", "Borrow");
              });
          })
          .Events(e => e.Change("dropDownChange"))
          .HtmlAttributes(new { style = "width: 100%" })
            )
        </div>
    </div>
    
    <input type="button" value="Add next" id="addNext" />
     
</div>
<script>
    var TempId = 2;
    var booksList;
    var bookToRemove;
    var indexToRemove;
    function cascadeDD()
    {
        alert("Cascade");
    }
    function myFunction(item,index)
    {
        
        if (item.BookId == bookToRemove)
        {
            alert("wejsszlo");
            indexToRemove = index;
        };
    }
    function addDropDownList(id)
    {
        
        var dropDownId = "#dropdownlist" + id;
        if (id > 1)
        {
            debugger;
            id--;
            var dataFromDropDown;
            var previousDropDownId = "#dropdownlist" + id;
            var previousdropDownList = $(previousDropDownId).data("kendoDropDownList");
            var bookId = previousdropDownList.value();
            var url = '@Url.Action("RetrieveBorrows", "Borrow")' + "/" + bookId;
        }
        else
        {
            var url = '@Url.Action("RetrieveBorrows", "Borrow")'+"/"+ 0;

        }
        
        $.get(url, function (result) {
            
            
            debugger;
            
            $(dropDownId).kendoDropDownList({
                  dataSource: result,
                  dataTextField: "Title",
                  dataValueField: "BookId",
                  change: dropDownChange,
                  cascade: cascadeDD ,
                  animation: {
                    close:{
                              effects: "fadeOut zoom:out",
                              duration: 300
                          },
                    open: {
                              effects: "fadeIn zoom:in",
                              duration: 300
                          }
                  }
            });
            var dataDD = result;
            var previousWnd = $(previousDropDownId).data("kendoDropDownList");
            var dropDownList = $(dropDownId).data("kendoDropDownList");
            bookToRemove = dropDownList.value();
            dataFromDropDown = previousWnd.dataSource._data;
            dataFromDropDown.forEach(myFunction);
            dataFromDropDown.slice(indexToRemove);
            dataFromDropDown.forEach(myFunction);
            alert(indexToRemove);

            
        })
        debugger;
        //var dt = dataFromDropDown;
        //var previousWnd = $(previousDropDownId).data("kendoDropDownList");
        //var dropDownList = $(dropDownId).data("kendoDropDownList");
        //bookToRemove = previousWnd.value();
        //dataFromDropDown.forEach(myFunction);
        //alert(indexToRemove);
        //dataFromDropDown.slice(indexToRemove);
        //previousWnd.content(dataFromDropDown);
    }
</script>